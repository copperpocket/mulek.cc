---
import MainLayout from "./MainLayout.astro";
import Header from "@/components/Header.astro";
import Footer from "@/components/Footer.astro";
import BackgroundParticles from "@/components/BackgroundParticles.astro";
import "@/styles/global.css";

const { data } = Astro.props;

if (!data) {
  throw new Error("BlogPostLayout requires a 'data' prop");
}

const formattedDate = new Date(data.pubDate).toLocaleDateString("en-US", {
  year: "numeric",
  month: "long",
  day: "numeric",
});
---

<MainLayout title={data.title} description={data.description}>
  <BackgroundParticles minHeight="0" maxHeight="100%" particleCount={150} />
  <Header />

  <div id="post-container" class="relative z-20 min-h-screen">
    <article class="container mx-auto px-4 py-8 max-w-4xl">
      <div class="text-center pb-8 border-b border-neutral-200 dark:border-neutral-700">
        <div class="text-xs text-neutral-500 dark:text-neutral-400 mb-2">
          <span class="font-medium">{data.author}</span>
          <span class="mx-2 text-neutral-300 dark:text-neutral-600">/</span>
          <time datetime={data.pubDate}>{formattedDate}</time>
        </div>

        <h1 class="text-3xl font-extrabold text-neutral-800 dark:text-neutral-200 sm:text-5xl">
          {data.title}
        </h1>
        <p class="text-lg text-neutral-600 dark:text-neutral-400 mt-4 max-w-2xl mx-auto">
          {data.description}
        </p>
      </div>

      <div class="flex flex-wrap justify-center gap-2 mt-6 mb-12">
        {data.tags?.map((tag: string) => (
          <span
            class="text-xs font-medium px-3 py-1 rounded-full bg-accent/20 dark:bg-accent/30 text-accent border border-accent/50"
          >
            #{tag}
          </span>
        ))}
      </div>

      <div class="prose dark:prose-invert max-w-prose mx-auto lg:prose-lg">
        <slot />
      </div>
    </article>
  </div>

  <Footer />
</MainLayout>
